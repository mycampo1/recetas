{% extends 'users/base.html' %}
{% load static %}

{% block title %}Inicio{% endblock %}

{% block contenido %}
<h1>Recetario</h1>

<!-- Formulario de búsqueda -->
<form method="get">
    <input type="text" name="q" placeholder="Buscar recetas..." value="{{ query }}">
    <button type="submit">Buscar</button>
</form>

<hr>

<!-- Listado de recetas -->
{% if recetas %}
    <ul>
        {% for receta in recetas %}
            <li>
                <strong>{{ receta.titulo }}</strong> ({{ receta.tiempo }} min) — Etiquetas: {{ receta.etiquetas }}
                {% if user.is_authenticated %}
                    <a href="{% url 'calificar_receta' receta.id %}">Calificar</a>
                {% else %}
                    <a href="{% url 'iniciar_sesion' %}?next={% url 'calificar_receta' receta.id %}">Calificar</a>
                {% endif %}
            </li>
        {% endfor %}
    </ul>
{% else %}
    <p>No se encontraron recetas.</p>
{% endif %}

<!-- Botón para abrir el modal de creación de recetas (solo para superusuarios) -->
{% if user.is_superuser %}
    <button type="button" id="openModalButton">Crear Receta</button>
{% endif %}

<!-- Modal para crear recetas -->
<div id="modalCrearReceta" class="modal">
    <div class="modal-content">
        <button class="modal-close">&times;</button>
        <h2>Crear Receta</h2>
        <form method="post" enctype="multipart/form-data">
            {% csrf_token %}
            {{ formulario.as_p }}
            <button type="submit">Guardar</button>
            <button type="button" id="cancelModalButton">Cancelar</button>
        </form>
    </div>
</div>
{% endblock %}
